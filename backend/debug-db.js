// Debug script to check database structure
import mongoose from 'mongoose';\nimport User from './models/userModel.js';\nimport Teacher from './models/teacherModel.js';\nimport Conversation from './models/conversationModel.js';\nimport Message from './models/messageModel.js';\n\nasync function debugDatabase() {\n  try {\n    console.log('üîç Debugging database structure...');\n    \n    // Check Users\n    const userCount = await User.countDocuments();\n    const sampleUser = await User.findOne().select('fullName email profileImage');\n    console.log(`\\nüë• Users: ${userCount} total`);\n    if (sampleUser) {\n      console.log('Sample User:', {\n        id: sampleUser._id,\n        name: sampleUser.fullName,\n        email: sampleUser.email,\n        hasProfileImage: !!sampleUser.profileImage\n      });\n    }\n    \n    // Check Teachers\n    const teacherCount = await Teacher.countDocuments();\n    const sampleTeacher = await Teacher.findOne().select('fullName email profileImage');\n    console.log(`\\nüë®‚Äçüè´ Teachers: ${teacherCount} total`);\n    if (sampleTeacher) {\n      console.log('Sample Teacher:', {\n        id: sampleTeacher._id,\n        name: sampleTeacher.fullName,\n        email: sampleTeacher.email,\n        hasProfileImage: !!sampleTeacher.profileImage\n      });\n    }\n    \n    // Check Conversations\n    const convCount = await Conversation.countDocuments();\n    const sampleConv = await Conversation.findOne();\n    console.log(`\\nüí¨ Conversations: ${convCount} total`);\n    if (sampleConv) {\n      console.log('Sample Conversation:', {\n        id: sampleConv._id,\n        participants: sampleConv.participants.map(p => ({\n          userId: p.userId,\n          model: p.participantsModel\n        }))\n      });\n      \n      // Try to find the actual users\n      for (const participant of sampleConv.participants) {\n        console.log(`\\nChecking participant ${participant.userId} (${participant.participantsModel}):`);\n        try {\n          if (participant.participantsModel === 'User') {\n            const user = await User.findById(participant.userId);\n            console.log('  Found User:', user ? user.fullName : 'NOT FOUND');\n          } else if (participant.participantsModel === 'Teacher') {\n            const teacher = await Teacher.findById(participant.userId);\n            console.log('  Found Teacher:', teacher ? teacher.fullName : 'NOT FOUND');\n          }\n        } catch (error) {\n          console.log('  Error:', error.message);\n        }\n      }\n    }\n    \n    // Check Messages\n    const msgCount = await Message.countDocuments();\n    const sampleMsg = await Message.findOne();\n    console.log(`\\nüì® Messages: ${msgCount} total`);\n    if (sampleMsg) {\n      console.log('Sample Message:', {\n        id: sampleMsg._id,\n        sender: sampleMsg.sender,\n        senderModel: sampleMsg.senderModel,\n        content: sampleMsg.content.substring(0, 30) + '...'\n      });\n      \n      // Try to find the sender\n      console.log(`\\nChecking sender ${sampleMsg.sender} (${sampleMsg.senderModel}):`);\n      try {\n        if (sampleMsg.senderModel === 'User') {\n          const user = await User.findById(sampleMsg.sender);\n          console.log('  Found User:', user ? user.fullName : 'NOT FOUND');\n        } else if (sampleMsg.senderModel === 'Teacher') {\n          const teacher = await Teacher.findById(sampleMsg.sender);\n          console.log('  Found Teacher:', teacher ? teacher.fullName : 'NOT FOUND');\n        }\n      } catch (error) {\n        console.log('  Error:', error.message);\n      }\n    }\n    \n    console.log('\\n‚úÖ Debug completed!');\n    \n  } catch (error) {\n    console.error('‚ùå Debug failed:', error);\n  }\n}\n\n// Connect and run debug\nasync function runDebug() {\n  try {\n    const MONGODB_URI = process.env.MONGODB_URI || 'mongodb://localhost:27017/mdai';\n    await mongoose.connect(MONGODB_URI);\n    console.log('üîó Connected to MongoDB');\n    \n    await debugDatabase();\n    \n  } catch (error) {\n    console.error('‚ùå Database connection failed:', error);\n  } finally {\n    await mongoose.disconnect();\n    console.log('üîå Disconnected from MongoDB');\n  }\n}\n\nif (import.meta.url === `file://${process.argv[1]}`) {\n  runDebug();\n}\n\nexport { debugDatabase };